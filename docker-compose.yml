version: '3.8'

services:
  # app:
  #   build:
  #     context: .
  #     dockerfile: Dockerfile
  #   container_name: ${APP_CONTAINER_NAME:-express-ts-api}
  #   restart: unless-stopped
  #   ports:
  #     - '${APP_PORT:-3000}:3000'
  #   environment:
  #     - NODE_ENV=${NODE_ENV:-production}
  #     - PORT=3000
  #     - HOST=0.0.0.0
  #     - API_PREFIX=${API_PREFIX:-/api}
  #     - CORS_ORIGIN=${CORS_ORIGIN:-*}
  #     - RATE_LIMIT_WINDOW_MS=${RATE_LIMIT_WINDOW_MS:-900000}
  #     - RATE_LIMIT_MAX_REQUESTS=${RATE_LIMIT_MAX_REQUESTS:-100}
  #     - LOG_LEVEL=${LOG_LEVEL:-info}
  #     - MONGODB_URI=mongodb://mongo:27017/${MONGO_DB_NAME:-mydb}
  #     - REDIS_URL=redis://redis:6379
  #   volumes:
  #     - ./logs:/app/logs
  #   networks:
  #     - app-network
  #   depends_on:
  #     - mongo
  #     - redis

  # MongoDB
  # mongo:
  #   platform: linux/amd64
  #   image: mongo:6.0
  #   container_name: ${MONGO_CONTAINER_NAME:-mongodb}
  #   restart: unless-stopped
  #   ports:
  #     - '${MONGO_PORT:-27017}:27017'
  #   environment:
  #     - MONGO_INITDB_DATABASE=${MONGO_DB_NAME:-mydb}
  #   volumes:
  #     - mongo-data:/data/db
  #   networks:
  #     - app-network

  # Mongo Express - MongoDB GUI
  # mongo-express:
  #   platform: linux/amd64
  #   image: mongo-express:latest
  #   container_name: ${MONGO_EXPRESS_CONTAINER_NAME:-mongo-express}
  #   restart: unless-stopped
  #   ports:
  #     - '${MONGO_EXPRESS_PORT:-8081}:8081'
  #   environment:
  #     - ME_CONFIG_MONGODB_SERVER=${MONGO_CONTAINER_NAME:-mongodb}
  #     - ME_CONFIG_MONGODB_PORT=27017
  #     - ME_CONFIG_BASICAUTH_USERNAME=${MONGO_EXPRESS_USER:-admin}
  #     - ME_CONFIG_BASICAUTH_PASSWORD=${MONGO_EXPRESS_PASSWORD:-admin123}
  #   depends_on:
  #     - mongo
  #   networks:
  #     - app-network

  # Redis
  redis:
    image: redis:${REDIS_VERSION:-7-alpine}
    container_name: ${REDIS_CONTAINER_NAME:-redis-cache}
    restart: unless-stopped
    ports:
      - '${REDIS_PORT:-6379}:6379'
    networks:
      - app-network

  # Redis Insight
  redis-insight:
    image: redis/redisinsight:latest
    container_name: ${REDIS_INSIGHT_CONTAINER_NAME:-redis-insight}
    restart: unless-stopped
    ports:
      - '${REDIS_INSIGHT_PORT:-8082}:5540'
    networks:
      - app-network
    depends_on:
      - redis
    environment:
      - REDIS_HOST=redis
      - REDIS_PORT=6379    

networks:
  app-network:
    driver: bridge

# volumes:
#   mongo-data:
